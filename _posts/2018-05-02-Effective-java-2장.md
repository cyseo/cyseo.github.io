---
layout: post
comments: true
title: "[JAVA] Effective java 2장"
author: Changyoun Seo
date: 2018-05-02 12:00:00 +0900
tags: [공부]
---

# 2장 객체의 생성과 삭제
## 규칙 1. 생성자 대신 정적 팩토리 메서드를 사용할 수 없는지 생각해 볼것
- 장점
    - 생성자와는 달리 이름이 존재
    - 호출할 떄 마다 새로운 객체를 생성할 필요는 없음
    - 반환값 자료형의 하위 자료형 객체를 반환할 수 있음
    - 형인자 자료형을 만들때 편리
    
```java
// 한가지 예로...
// 이것 보다는
Map<String, List<String>> m = new HashMap<String, List<String>>();

// 이렇게
public static <K, V> HashMap<K, V> newInstance() {
    return new HashMap<K, V>
}

// 사용할 떈
Map<String, List<String>> m = HashMap.newInstance();

// 다만 1.7부터는 이렇게 되지
Map<String, List<String>> m = new HashMap<>();
```

## 규칙 2. 생성자 인자가 많을 때는 Builder 패턴 적용을 고려해라
 - 보통 인자가 많고 선택적인 객체가 있을 때 이를 생성자로 풀기도, setter로 풀기도 어렵다. 둘다 더럽다.
 또 setter를 쭉 적는 경우 객체 일관성이 일시적으로 꺠질 수 있고, 변경 불가능 클래스를 만들 수 없다.
 이럴때 깔쌈하게 빌더패턴을 쓰면 좋다.
 
 - 다만 객체를 생성하기 위해서는 빌터 객체를 생성해야 하므로 성능에 민감하다면 단점이 될 수 있고, 보통 setter 보다 더 많은 코드를 요구하기 때문에 충분히 고려해야 한다.

## 규칙 3. private 생성자나 enum 자료형은 싱글턴 패턴을 따르도록 설계하라
 - 싱글톤이나 그 방법은 알겠으나, Enum을 사용하는게 좋다는 것은 잘 모르겠다.

## 규칙 4. 객체 생성을 막을 때에는 private 생성자를 사용하라
 - 정적 메서드나 필드만 모아둔 클래스를 사용하고 싶을 떄가 있다. 어줍잖게 생성자를 생략하거나 abstract 달지 말고 그냥 private 생성자를 넣어둬라.
 사용자가 헷갈리지 않고, 하위 클래스를 만들거나 구현해 만들어 쓰지 못하도록 막을 수 있다.
 
## 규칙 5. 불필요한 객체는 만들지 말라
 - 생성에 비용이 크고, 재사용되는 값이면 static 으로 한번 만들어 같이 쓰자
 - 객체 재사용은 보통 그냥 새로 객체를 만드는 것보다 더 큰 자원을 사용함
 - 객체 풀을 만들어 객체 생성을 피하는 기법은 객체 생성이 진짜진짜 큰 자원을 요구할때만 사용하자
 - 오토박싱에 유의 할것

```java
public static void main() {
    Long sum = 0;
    // for 문으로 많이많이 반복~~
        sum += i;
}
```
 이 친구는 'L'ong 덕분에 쓸데없는 객체가 반복마다 생성된다.
 
## 규칙 6. 유효기간이 지난 객체 참조는 폐기하라
 - 가비지 컬렉터가 성능이 많이 좋아졌지만, 스스로 메모리 관리한다는 객기는 부리지 말것
 - 가비지 컬렉터가 참조가 있는지 없는지 구분할 수 없는 케이스가 있다. `= null`로 알려주자.
 
## 규칙 7. 종료자 사용을 피하라
 - 원래 잘 안쓴다. 필요하다면 메서드를 정의해서 사용자가 부르도록 할것. `some.close()` 같이